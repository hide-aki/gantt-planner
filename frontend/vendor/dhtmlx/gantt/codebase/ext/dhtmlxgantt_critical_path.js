/*
@license

dhtmlxGantt v.4.2.0 Professional
This software is covered by DHTMLX Commercial License. Usage without proper license is prohibited.

(c) Dinamenta, UAB.
*/
gantt._formatLink=function(t){var n=[],e=this._get_link_target(t),a=this._get_link_source(t);if(!a||!e)return n;if(gantt.isChildOf(a.id,e.id)&&gantt._isProject(e)||gantt.isChildOf(e.id,a.id)&&gantt._isProject(a))return n;for(var i=this._getImplicitLinks(t,a,function(t){return 0}),r=gantt.config.auto_scheduling_move_projects,s=this._isProject(e)?this.getSubtaskDates(e.id):{start_date:e.start_date,end_date:e.end_date},g=this._getImplicitLinks(t,e,function(t){return r?t.$target.length||gantt.getState().drag_id==t.id?0:gantt.calculateDuration({
start_date:s.start_date,end_date:t.start_date,task:a}):0}),o=0;o<i.length;o++)for(var c=i[o],u=0;u<g.length;u++){var d=g[u],l=1*c.lag+1*d.lag,h={id:t.id,type:t.type,source:c.task,target:d.task,lag:(1*t.lag||0)+l};n.push(gantt._convertToFinishToStartLink(d.task,h,a,e))}return n},gantt._getImplicitLinks=function(t,n,e){var a=[];return this._isProject(n)?this.eachTask(function(t){this._isProject(t)||a.push({task:t.id,lag:e(t)})},n.id):a.push({task:n.id,lag:0}),a},gantt._getDirectDependencies=function(t,n){
for(var e=[],a=[],i=n?t.$source:t.$target,r=0;r<i.length;r++){var s=this.getLink(i[r]);this.isTaskExists(s.source)&&this.isTaskExists(s.target)&&e.push(this.getLink(i[r]))}for(var r=0;r<e.length;r++)a=a.concat(this._formatLink(e[r]));return a},gantt._getInheritedDependencies=function(t,n){var e=[],a=[];if(this.isTaskExists(t.id)){this._eachParent(function(t){this._isProject(t)&&a.push.apply(a,this._getDirectDependencies(t,n))},t.id,this);for(var i=0;i<a.length;i++){var r=n?a[i].source:a[i].target;
r==t.id&&e.push(a[i])}}return e},gantt._getDirectSuccessors=function(t){return this._getDirectDependencies(t,!0)},gantt._getInheritedSuccessors=function(t){return this._getInheritedDependencies(t,!0)},gantt._getDirectPredecessors=function(t){return this._getDirectDependencies(t,!1)},gantt._getInheritedPredecessors=function(t){return this._getInheritedDependencies(t,!1)},gantt._getSuccessors=function(t){return this._getDirectSuccessors(t).concat(this._getInheritedSuccessors(t))},gantt._getPredecessors=function(t){
return this._getDirectPredecessors(t).concat(this._getInheritedPredecessors(t))},gantt._convertToFinishToStartLink=function(t,n,e,a){var i={target:t,link:gantt.config.links.finish_to_start,id:n.id,lag:n.lag||0,source:n.source,preferredStart:null},r=0;switch(n.type){case gantt.config.links.start_to_start:r=-e.duration;break;case gantt.config.links.finish_to_finish:r=-a.duration;break;case gantt.config.links.start_to_finish:r=-e.duration-a.duration;break;default:r=0}return i.lag+=r,i},gantt.config.highlight_critical_path=!1,
gantt._criticalPathHandler=function(){gantt.config.highlight_critical_path&&gantt.render()},gantt.attachEvent("onAfterLinkAdd",gantt._criticalPathHandler),gantt.attachEvent("onAfterLinkUpdate",gantt._criticalPathHandler),gantt.attachEvent("onAfterLinkDelete",gantt._criticalPathHandler),gantt.attachEvent("onAfterTaskAdd",gantt._criticalPathHandler),gantt.attachEvent("onAfterTaskUpdate",gantt._criticalPathHandler),gantt.attachEvent("onAfterTaskDelete",gantt._criticalPathHandler),gantt._isCriticalTask=function(t,n){
if(t&&t.id){var e=n||{};if(this._isProjectEnd(t))return!0;e[t.id]=!0;for(var a=this._getDependencies(t),i=0;i<a.length;i++){var r=this.getTask(a[i].target);if(this._getSlack(t,r,a[i])<=0&&!e[r.id]&&this._isCriticalTask(r,e))return!0}return!1}},gantt.isCriticalTask=function(t){return gantt.assert(!(!t||void 0===t.id),"Invalid argument for gantt.isCriticalTask"),this._isCriticalTask(t,{})},gantt.isCriticalLink=function(t){return this.isCriticalTask(gantt.getTask(t.source))},gantt.getSlack=function(t,n){
for(var e=[],a={},i=0;i<t.$source.length;i++)a[t.$source[i]]=!0;for(var i=0;i<n.$target.length;i++)a[n.$target[i]]&&e.push(n.$target[i]);for(var r=[],i=0;i<e.length;i++){var s=this.getLink(e[i]);r.push(this._getSlack(t,n,this._convertToFinishToStartLink(s.id,s,t,n)))}return Math.min.apply(Math,r)},gantt._getSlack=function(t,n,e){var a=this.config.types,i=null;i=this._get_safe_type(t.type)==a.milestone?t.start_date:t.end_date;var r=n.start_date,s=0;s=+i>+r?-this.calculateDuration({start_date:r,end_date:i,
task:t}):this.calculateDuration({start_date:i,end_date:r,task:t});var g=e.lag;return g&&1*g==g&&(s-=g),s},gantt._getProjectEnd=function(){var t=gantt.getTaskByTime();return t=t.sort(function(t,n){return+t.end_date>+n.end_date?1:-1}),t.length?t[t.length-1].end_date:null},gantt._isProjectEnd=function(t){return!this._hasDuration({start_date:t.end_date,end_date:this._getProjectEnd(),task:t})},gantt._getSummaryPredecessors=function(t){var n=[];return this._eachParent(function(t){this._isProject(t)&&(n=n.concat(gantt._getDependencies(t)));
},t),n},gantt._getDependencies=function(t){var n=this._getSuccessors(t).concat(this._getSummaryPredecessors(t));return n};
//# sourceMappingURL=../sources/ext/dhtmlxgantt_critical_path.js.map